from math import floor

import matplotlib.pyplot as plt

plt.rcParams.update(
    {
        "font.size": 22,
        "font.family": "Fira Code",
    }
)

title = ""
x_label = "Vantage Point X"
y_label = "Vantage Point Y"
z_label = "[Percentage] (%)"
z_min, z_max = 0, 100
x_ticks = [
    "ES",  # k5110
    "GB",  # k5110
    "FR",  # k5110
    "NL",  # k1001
    "NO",  # k5110
    "IT",  # k5110
    "DK",  # k5110
    "DE",  # k5110
    "CZ",  # k5110
    "AT",  # k1004
    "SE",  # k1002
    "PL",  # k1003
    "FI",  # k5110
]
y_ticks = x_ticks
table = [
    [
        100.0,
        100.0,
        1.5384615384615385,
        95.38461538461539,
        1.5384615384615385,
        3.076923076923077,
        1.5384615384615385,
        29.23076923076923,
        16.923076923076923,
        18.46153846153846,
        1.5384615384615385,
        3.076923076923077,
        1.5384615384615385,
    ],
    [
        6.243996157540826,
        100.0,
        18.539865513928916,
        5.95581171950048,
        23.246878001921228,
        17.675312199807877,
        22.76657060518732,
        19.404418828049952,
        1.2487992315081653,
        1.440922190201729,
        13.832853025936599,
        39.8655139289145,
        15.561959654178674,
    ],
    [
        0.5181347150259067,
        100.0,
        100.0,
        0.0,
        36.78756476683938,
        45.07772020725388,
        36.78756476683938,
        16.580310880829014,
        0.0,
        0.5181347150259067,
        0.0,
        98.44559585492227,
        23.316062176165804,
    ],
    [
        100.0,
        100.0,
        0.0,
        100.0,
        0.0,
        1.6129032258064515,
        0.0,
        29.032258064516128,
        17.741935483870968,
        19.35483870967742,
        0.0,
        0.0,
        1.6129032258064515,
    ],
    [
        0.411522633744856,
        99.58847736625515,
        29.218106995884774,
        0.0,
        100.0,
        15.22633744855967,
        90.94650205761317,
        25.51440329218107,
        0.411522633744856,
        0.0,
        30.041152263374485,
        60.90534979423868,
        8.23045267489712,
    ],
    [
        1.0869565217391304,
        100.0,
        47.28260869565217,
        0.5434782608695652,
        20.108695652173914,
        100.0,
        20.108695652173914,
        14.673913043478262,
        0.5434782608695652,
        0.5434782608695652,
        0.5434782608695652,
        98.91304347826087,
        21.73913043478261,
    ],
    [
        0.4219409282700422,
        100.0,
        29.957805907172997,
        0.0,
        93.24894514767932,
        15.611814345991561,
        100.0,
        26.582278481012658,
        0.4219409282700422,
        0.0,
        30.379746835443036,
        62.447257383966246,
        0.0,
    ],
    [
        9.405940594059405,
        100.0,
        15.841584158415841,
        8.910891089108912,
        30.693069306930692,
        13.366336633663366,
        31.18811881188119,
        100.0,
        2.4752475247524752,
        2.9702970297029703,
        27.722772277227723,
        32.17821782178218,
        21.782178217821784,
    ],
    [
        84.61538461538461,
        100.0,
        0.0,
        84.61538461538461,
        7.6923076923076925,
        7.6923076923076925,
        7.6923076923076925,
        38.46153846153846,
        100.0,
        84.61538461538461,
        7.6923076923076925,
        0.0,
        0.0,
    ],
    [
        80.0,
        100.0,
        6.666666666666667,
        80.0,
        0.0,
        6.666666666666667,
        0.0,
        40.0,
        73.33333333333333,
        100.0,
        0.0,
        13.333333333333334,
        13.333333333333334,
    ],
    [
        0.6896551724137931,
        99.3103448275862,
        0.0,
        0.0,
        50.3448275862069,
        0.6896551724137931,
        49.6551724137931,
        38.62068965517241,
        0.6896551724137931,
        0.0,
        100.0,
        0.0,
        0.0,
    ],
    [
        0.477326968973747,
        99.0453460620525,
        45.346062052505964,
        0.0,
        35.32219570405728,
        43.436754176610975,
        35.32219570405728,
        15.513126491646778,
        0.0,
        0.477326968973747,
        0.0,
        100.0,
        19.331742243436754,
    ],
    [
        0.6060606060606061,
        98.18181818181819,
        27.272727272727273,
        0.6060606060606061,
        12.121212121212121,
        24.242424242424242,
        0.0,
        26.666666666666668,
        0.0,
        1.2121212121212122,
        0.0,
        49.09090909090909,
        100.0,
    ],
]


fig, ax = plt.subplots(figsize=(13, 13))

im = ax.imshow(table, vmin=z_min, vmax=z_max, cmap="viridis")

ax.set_title(title)
ax.set_xlabel(x_label, labelpad=10.0)
ax.xaxis.set_label_position("top")
ax.tick_params(top=True, labeltop=True, bottom=False, labelbottom=False)
ax.set_ylabel(y_label)
cbar = ax.figure.colorbar(
    im,
    ticks=[z_min, z_max],
    shrink=0.5,
    # label=z_label,
    # pad=0.01,
)
cbar.ax.set_yticklabels([z_min, z_max])
cbar.ax.text(2, 21.5, z_label, rotation=90)

ax.set_xticks(range(len(x_ticks)), labels=x_ticks, rotation=0)
ax.set_yticks(range(len(y_ticks)), labels=y_ticks)

for i in range(len(y_ticks)):
    for j in range(len(x_ticks)):
        if table[i][j] == 0:
            continue
        text = f"{floor(table[i][j]):.0f}"
        if text == "0":
            text = "<1"
        textcolor = "w"
        if table[i][j] * 2 > z_min + z_max:
            textcolor = "k"
        ax.text(j, i, text, ha="center", va="center", color=textcolor)

ax.spines[:].set_visible(False)

plt.savefig(f"heatmap-overlap_k5110-1001-2-3-4.png", bbox_inches="tight")
plt.close(fig)
